<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
  <title>AI Browser</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="browser-container">
    <!-- Tab Bar -->
    <div id="tab-bar">
      <div id="tabs-container"></div>
      <button id="new-tab-btn" class="icon-btn" title="New Tab">+</button>
    </div>

    <!-- Navigation Bar -->
    <div id="nav-bar">
      <button id="back-btn" class="nav-btn" disabled>←</button>
      <button id="forward-btn" class="nav-btn" disabled>→</button>
      <button id="reload-btn" class="nav-btn">↻</button>
      
      <div id="url-bar-container">
        <input type="text" id="url-bar" placeholder="Search or enter URL with AI assistance...">
        <button id="ai-assist-btn" class="icon-btn" title="AI Assistant">🤖</button>
      </div>
      
      <button id="settings-btn" class="icon-btn" title="Settings">⚙️</button>
    </div>

    <!-- AI Command Bar (hidden by default) -->
    <div id="ai-command-bar" class="hidden">
      <input type="text" id="ai-input" placeholder="Ask AI anything about this page...">
      <div id="ai-suggestions"></div>
    </div>

    <!-- Main Content Area with AI Sidebar -->
    <div id="main-container">
      <!-- Webview Container -->
      <div id="webview-container"></div>
      
      <!-- AI Sidebar -->
      <div id="ai-sidebar" class="ai-sidebar collapsed">
        <!-- Sidebar Toggle -->
        <button id="sidebar-toggle" class="sidebar-toggle" title="Toggle AI Assistant">
          <span class="toggle-icon">🤖</span>
        </button>
        
        <!-- Sidebar Content -->
        <div class="sidebar-content">
          <!-- Header -->
          <div class="sidebar-header">
            <h2>AI Assistant</h2>
            <span class="ai-model-badge">AI Assistant</span>
          </div>
          
          <!-- Quick Actions -->
          <div class="quick-actions">
            <button class="quick-action-btn" data-action="summarize">
              <span class="action-icon">📝</span>
              <span class="action-text">Summarize</span>
            </button>
            <button class="quick-action-btn" data-action="key-points">
              <span class="action-icon">🔑</span>
              <span class="action-text">Key Points</span>
            </button>
            <button class="quick-action-btn" data-action="translate">
              <span class="action-icon">🌐</span>
              <span class="action-text">Translate</span>
            </button>
            <button class="quick-action-btn" data-action="simplify">
              <span class="action-icon">🎯</span>
              <span class="action-text">Simplify</span>
            </button>
          </div>
          
          <!-- Chat Interface -->
          <div class="ai-chat-container">
            <div class="chat-messages" id="chat-messages">
              <div class="chat-message ai-message">
                <div class="message-avatar">🤖</div>
                <div class="message-content">
                  Hi! I'm your AI browsing assistant. I can help you understand, analyze, and interact with any webpage. What would you like to know?
                </div>
              </div>
            </div>
            
            <!-- Chat Input -->
            <div class="chat-input-container">
              <textarea 
                id="chat-input" 
                class="chat-input" 
                placeholder="Ask anything about this page..."
                rows="2"
              ></textarea>
              <button id="send-chat" class="send-button" title="Send message">
                <span>→</span>
              </button>
            </div>
          </div>
          
          <!-- Page Context -->
          <div class="page-context">
            <div class="context-header">
              <span class="context-icon">📄</span>
              <span class="context-title">Current Page</span>
            </div>
            <div class="context-info" id="page-context-info">
              <div class="context-url" id="context-url">No page loaded</div>
              <div class="context-stats" id="context-stats">
                <span class="stat-item">Words: <span id="word-count">0</span></span>
                <span class="stat-item">Reading time: <span id="reading-time">0 min</span></span>
              </div>
            </div>
          </div>
          
          <!-- History & Insights -->
          <div class="sidebar-section">
            <h3>Recent Insights</h3>
            <div class="insights-list" id="recent-insights">
              <div class="empty-state">
                <span class="empty-icon">💡</span>
                <p>Your AI insights will appear here</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- AI Response Overlay -->
    <div id="ai-overlay" class="hidden">
      <div id="ai-response-container">
        <div id="ai-response-header">
          <span id="ai-model-indicator"></span>
          <button id="close-ai-overlay" class="icon-btn">×</button>
        </div>
        <div id="ai-response-content"></div>
      </div>
    </div>

    <!-- Status Bar -->
    <div id="status-bar">
      <span id="security-indicator">🔒 Secure</span>
      <span id="privacy-indicator">🛡️ Privacy: High</span>
      <span id="ai-status">AI: Ready</span>
      <span id="stats">Blocked: <span id="blocked-count">0</span></span>
    </div>
  </div>

  <script src="renderer.js"></script>
  <script type="module" src="ai-handler.js"></script>
</body>
</html>